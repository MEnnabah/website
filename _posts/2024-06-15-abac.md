---
layout: post
title: "Access Control and Data"
date: 2024-06-15 00:00:00 +0000
categories: abac rbac rebac accesscontrol security
published: false
---

Let's say we're designing Dropbox, where users can upload files, and optionally give access to other users to view these file(s)/folder(s). Users belong to organisation, and admins can invite external users (from other organisations) to their resources.

To us, Dropbox, we're building a multi-tenant system, and security is a key requirement.

Organisation `Apple` could have the following file structure:
- /
  - Contracts
    - Template
      - EmploymentContract.pdf
      - ESOPs.pdf
      - P45.pdf
    - Active
      - TimCook_ESOPs.pdf
      - CraigFederighi_ESOPs.pdf
      - SteveJobs_P45.pdf
      - OpenAIPartnership.pdf
  - Device
    - iPhone
      - 2031
        Features.pdf
        Image.jpg
        Model.usdz

Everyone at `Apple` could read `/Contracts/Template/*`, and their own files in `/Contracts/Active/${name}.pdf`. However, only executives could create/read/update `/Device/**/**`, unless invited by an executive.

For example, Craig Federighi can read every file in `/Contracts/Template/*`, and can read `CraigFederighi_ESOPs.pdf`, and every file in `/Device/**/**`. However, Sam Altman can read/update `Features.pdf`, and can also read `OpenAIPartnership.pdf`.

Our authorisation system should answer the following the questions:

- Can a principal invoke an action on a resource? (`user:SamAltman` `read` `file:CraigFederighi_ESOPs.pdf`): `false`
- List the IDs of a resource type where a principal can invoke an action (`user:SamAltman` `read` `file:?`): [`Features.pdf`, `OpenAIPartnership.pdf`]
- List the principals who can invoke an action on a resource (`user:?` `read` `file:?`): [`TimCook`, `CraigFederighi`]
- List the actions a principal can invoke on a resource (`user:TimCook` `?` `file:Features.pdf`) [`read`, `update`]
